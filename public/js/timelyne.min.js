var timelyne = function(options) {
    "use strict";
    function calculatePhase(something) {
        return tlThreshholdDev > something ? tlHexDev : tlThreshholdReview > something ? tlHexReview : tlThreshholdTest > something ? tlHexTest : void 0;
    }
    function dateFormatter(remaining) {
        var remDays, remHours, remMins, remSecs;
        return remDays = Math.floor(remaining / day), remaining -= remDays * day, remHours = Math.floor(remaining / hour), 
        remaining -= remHours * hour, remMins = Math.floor(remaining / minute), remaining -= remMins * minute, 
        remSecs = Math.floor(remaining / second), remaining -= remSecs * second, leadingZero(remDays) + ":" + leadingZero(remHours) + ":" + leadingZero(remMins) + ":" + leadingZero(remSecs);
    }
    function leadingZero(num) {
        return 10 > num ? "0" + num : num;
    }
    function initilizePhases() {
        var tlElementDev = document.getElementById(tlPhaseDev), tlElementReview = document.getElementById(tlPhaseReview), tlElementTest = document.getElementById(tlPhaseTest);
        tlElementDev.style.width = 100 * (tlLengthDev / tlDiff) + "%", tlElementDev.style.backgroundColor = tlHexDev, 
        tlElementReview.style.width = 100 * (tlLengthReview / tlDiff) + "%", tlElementReview.style.backgroundColor = tlHexReview, 
        tlElementTest.style.width = 100 * (tlLengthTest / tlDiff) + "%", tlElementTest.style.backgroundColor = tlHexTest;
    }
    function updateSomething() {
        var updateNow = Date.now(), updateLeft = tlEnd - updateNow, updatePast = updateNow - tlStart;
        tlProgressLabel.innerHTML = dateFormatter(updateLeft) + " <span class='tl-progress-fin'></span>", 
        tlProgressLabel.style.backgroundColor = calculatePhase(updatePast / tlDiff), tlProgressLabel.children[0].style.borderTopColor = calculatePhase(updatePast / tlDiff), 
        tlProgressFull.style.width = 100 * (updatePast / tlDiff) + "%";
    }
    var fps = 16.667, second = 1e3, minute = 60 * second, hour = 60 * minute, day = 24 * hour, tlStart = options.start, tlEnd = options.end, tlDiff = tlEnd - tlStart, tlProgressBar = document.getElementById("tl-test-01").children[1], tlProgressFull = tlProgressBar.children[0], tlProgressLabel = tlProgressFull.children[0], tlPhaseDev = "tl-phase-dev", tlPhaseReview = "tl-phase-review", tlPhaseTest = "tl-phase-test", tlLengthReview = 1 * day, tlLengthTest = 3 * day, tlLengthDev = tlDiff - tlLengthTest - tlLengthReview, tlThreshholdDev = tlLengthDev / tlDiff, tlThreshholdReview = tlThreshholdDev + tlLengthReview / tlDiff, tlThreshholdTest = tlThreshholdDev + tlThreshholdReview + tlLengthTest / tlDiff, tlHexDev = "#178DE3", tlHexReview = "#B0B000", tlHexTest = "#E7322E";
    initilizePhases(), setInterval(updateSomething, fps);
}, opts = {
    start: new Date("Sep 01, 2013 08:00"),
    end: new Date("Sep 07, 2013 18:00")
};

timelyne(opts);